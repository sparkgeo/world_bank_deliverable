{
  "hash": "6d50f6c5aeb8eed6274e6e2beb5eaf60",
  "result": {
    "markdown": "---\ntitle: \"Beitbridge GPS Exploration\"\nauthor: \"Sparkgeo\"\ntoc: true\nformat:\n  html:\n    theme: zephyr\n    html-math-method: katex\n    code-tools: true\n    embed-resources: true\n    link-external-icon: true\n    link-external-newwindow: true\n    code-block-bg: true\n    code-block-border-left: \"#31BAE9\"\n    df-print: kable\nexecute:\n  warning: false\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readr)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(skimr)\nlibrary(lubridate)\nlibrary(tidymodels)\nlibrary(tidyverse)\n```\n:::\n\n\nThis notebook is exploring the Beitbridge GPS data with plots and limited statistics. Some of these plots are throw-away.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbeitbridge_border = read_csv(\"../data/processed/Beitbridge_Counts_Wait_Time_2018_2022.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbeitbridge_border %>%\n  ggplot(aes(x = Count_Events, y = Median_Minutes, group = Direction, col = Direction)) + \n  geom_point() +\n  scale_color_viridis_d(alpha=0.3,option = \"plasma\", end = .7) +\n  labs(x = \"Count\", y = \"Median Minutes\")\n```\n\n::: {.cell-output-display}\n![](gps_eda_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbeitbridge_border %>%\n  ggplot(aes(x = Count_Events, y = Median_Minutes, group= as_factor(StartHour), col = as_factor(StartHour))) + \n  geom_point(alpha = 0.7) +\n  scale_color_viridis_d(\"Hour\", option = \"plasma\", end = .7, alpha =0.2)+\n  labs(x = \"Count\", y = \"Median Minutes\")\n```\n\n::: {.cell-output-display}\n![](gps_eda_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n# Subsets\n\n## SA - Zimbabwe\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsa_zimbabwe = beitbridge_border %>% filter(Direction == \"SA-Zimbabwe\")\n```\n:::\n\n\n# Monthly Count\n\n\n::: {.cell}\n\n```{.r .cell-code}\n monthly_count_sa = sa_zimbabwe %>% group_by(year=year(StartDate), month=month(StartDate, label=TRUE)) %>% summarize(Month_Total = sum(Count_Events))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmonthly_count_sa %>%\n  ggplot(aes(x=month, y=Month_Total, group=as_factor(year), colour=as_factor(year))) +\n  geom_line()+\n  labs(y = 'Count of Vehicles Processed', x= \"Month\", caption = \"For Vehicles with GPS*\", colour =\"Year\")+\n  scale_color_viridis_d(option = \"magma\", end = .7)\n```\n\n::: {.cell-output-display}\n![](gps_eda_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nWe'll start with the South Africa --> Zimbabwe direction. We can tell from the plot above there seems to be higher counts within hour `0`.\n\nWe can filter and slice our graph by the hour. Let's look at `0`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsa_zimbabwe %>%\n  filter(StartHour == 0 )%>%\n  ggplot(aes(x = Count_Events, y = Median_Minutes, group= as_factor(StartHour), col = as_factor(StartHour))) + \n  geom_point(alpha = 0.7) +\n  scale_color_viridis_d(\"Hour\",option = \"plasma\", end = .7)+\n  labs(x = \"Count\", y = \"Median Minutes\")\n```\n\n::: {.cell-output-display}\n![](gps_eda_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsa_zimbabwe %>%\n  filter(StartHour == 0 )%>%\n  ggplot(aes(x = Count_Events, y = Median_Minutes, group = as_factor(year(StartDate)), col = as_factor(year(StartDate)))) +\n  geom_point(alpha = 0.7) +\n  scale_color_viridis_d(\"Year\",option = \"plasma\", end = .7)+\n  labs(x = \"Count\", y = \"Median Minutes\")\n```\n\n::: {.cell-output-display}\n![](gps_eda_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\nViolin plot zoomed in by start hour 0 and Year.\n\n::: {.cell}\n\n```{.r .cell-code}\nsa_zimbabwe %>%\n  filter(StartHour == 0 )%>%\n  ggplot(aes(x = as_factor(year(StartDate)), y = Median_Minutes)) +\n  geom_violin(alpha = 0.7) +\n  scale_color_viridis_d(\"Year\",option = \"plasma\", end = .7)+\n  labs(x = \"Year\", y = \"Median Minutes\")\n```\n\n::: {.cell-output-display}\n![](gps_eda_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsa_zimbabwe %>%\n  filter(StartHour == 0 )%>%\n  ggplot(aes(x = Count_Events, y = Median_Minutes, group = as_factor(wday(StartDate, TRUE)), col = as_factor(wday(StartDate, TRUE)))) +\n  geom_point(alpha = 0.7) +\n  scale_color_viridis_d(\"Day of Week\",option = \"plasma\", end = .7)+\n  labs(x = \"Count\", y = \"Median Minutes\")\n```\n\n::: {.cell-output-display}\n![](gps_eda_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsa_zimbabwe %>%\n  filter(StartHour == 0 )%>%\n  ggplot(aes(x = Median_Minutes, y = as_factor(wday(StartDate, TRUE)), group = as_factor(wday(StartDate, TRUE)), col = as_factor(wday(StartDate, TRUE)))) +\n  geom_boxplot(alpha = 0.7) +\n  scale_color_viridis_d(\"Day of Week\",option = \"plasma\", end = .7)+\n  labs(x = \"Count\", y = \"Median Minutes\")\n```\n\n::: {.cell-output-display}\n![](gps_eda_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n\n## Day of Week\n\nLet's look at day of week across the study period.\n\n::: {.cell}\n\n```{.r .cell-code}\nsa_zimbabwe %>%\n  ggplot(aes(x = Count_Events, y = Median_Minutes, group= as_factor(wday(StartDate, TRUE)), col = as_factor(wday(StartDate, TRUE)))) + \n  geom_point(alpha = 0.7) +\n  scale_color_viridis_d(\"Day of Week\", option = \"plasma\", end = .7, alpha =0.5)+\n  labs(x = \"Count\", y = \"Median Minutes\")\n```\n\n::: {.cell-output-display}\n![](gps_eda_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n## Zimbabwe - SA\n\n\n::: {.cell}\n\n```{.r .cell-code}\nzimbabwe_sa = beitbridge_border %>% filter(Direction == \"Zimbabwe-SA\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nzimbabwe_sa %>%\n  filter(year(StartDate)=='2019')%>%\n  ggplot(aes(x = Count_Events, y = Median_Minutes, group = as_factor(year(StartDate)), col = as_factor(year(StartDate)))) + \n  geom_point(alpha = 0.7) +\n   # geom_smooth(method = lm, se = FALSE) +\n  scale_color_viridis_d(\"Year\", option = \"plasma\", end = .7)+\n  labs(x = \"Count\", y = \"Median Minutes\")\n```\n\n::: {.cell-output-display}\n![](gps_eda_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\nConvert to long format for plotting\n\n\n::: {.cell}\n\n```{.r .cell-code}\nzim_long = zimbabwe_sa %>%\n  select(-Direction)%>%\n  pivot_longer(cols = c(Median_Minutes, Bottom_10__Minutes, Top_10__Minutes), values_to = 'minutes')\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nzim_long %>%\n  filter(StartDate == '2018-01-01' & Count_Events > 0)%>%\n  mutate(name = str_replace(name,\"_\",\" \"))%>%\n   mutate(name = str_replace(name,\"__\",\" \"))%>%\n  ggplot(aes(x = StartHour, y = minutes, group = name, col = name))+\n  geom_point()+\n  geom_line() +\n  labs(x = \"Hour of Day\", y = \"Minutes\", col = \"Legend\")\n```\n\n::: {.cell-output-display}\n![](gps_eda_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n zimbabwe_sa %>%\n  filter(StartDate == '2022-12-30')%>%\n  ggplot(aes(x = StartHour, y = Median_Minutes), colour = 'blue')+\n  geom_point()+\n  geom_line(colour = 'blue')+\n  geom_ribbon(aes(ymin = Bottom_10__Minutes, ymax = Top_10__Minutes), fill = 'light blue', alpha = 0.4)+\n  labs(x = \"Hour\", y=\"Median Minutes\")\n```\n\n::: {.cell-output-display}\n![](gps_eda_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n## Daily\n\n\n::: {.cell}\n\n```{.r .cell-code}\n zimbabwe_sa %>% group_by(StartDate) %>% summarize(Day_Total = sum(Count_Events))%>%ggplot(aes(x=StartDate, y=Day_Total))+geom_bar(stat = \"identity\")\n```\n\n::: {.cell-output-display}\n![](gps_eda_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\n# Monthly\n\n\n::: {.cell}\n\n```{.r .cell-code}\n monthly_count = zimbabwe_sa %>% group_by(year=year(StartDate), month=month(StartDate, label=TRUE)) %>% summarize(Month_Total = sum(Count_Events))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmonthly_count %>%\n  ggplot(aes(x=month, y=Month_Total, group=as_factor(year), colour=as_factor(year))) +\n  geom_line()+\n  labs(y = 'Count of Vehicles Processed', x= \"Month\", caption = \"For Vehicles with GPS*\", colour =\"Year\")+\n  scale_color_viridis_d(option = \"plasma\", end = .7)\n```\n\n::: {.cell-output-display}\n![](gps_eda_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n\nA clear difference during Covid and lock-downs when aggregated at a monthly scale.",
    "supporting": [
      "gps_eda_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}