---
title: "Trade Activity"
format: html
editor: visual
---

```{r}
library(dplyr)
library(comtradr)
library(ggplot2)
```

# Comtrade

Interface with and extract data from the United Nations Comtrade API. Comtrade provides country level shipping data for a variety of commodities, these functions allow for easy API query and data returned as a tidy data frame.

## Resources

https://cran.r-project.org/web/packages/comtradr/vignettes/comtradr-vignette.html

## Trade

Look up country codes and spelling to use the api, must be spelled exactly the same way.

```{r}
ct_country_lookup("South Africa", "partner")
ct_country_lookup("Zimbabwe", "partner")
```

Yearly data

```{r}
q <- ct_search(reporters = "Zimbabwe", 
               partners = c("South Africa"), 
               trade_direction = "all",
               start_date = 2018,
               end_date = 2022)

```

```{r}
q %>%
  ggplot(aes(x = year, y=trade_value_usd,color = factor(trade_flow), 
               shape = factor(trade_flow))) +
  geom_point(size = 2) +
  geom_line(size = 1) +
  scale_x_continuous(limits = c(min(q$year), max(q$year)), 
                     breaks = seq.int(min(q$year), max(q$year), 1)) +
  scale_color_manual(values = c("orange", "blue", "red"), 
                     name = "Trade\nFlow") +
  scale_shape_discrete(name = "Trade\nFlow") +
  labs(title = "Total Value (USD) of Zimbabwe Imports / Exports with SA, by Year", y = "Total Value (USD)") +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))
```

```{r}
q_sa <- q <- ct_search(reporters = "South Africa", 
               partners = c("Zimbabwe"), 
               trade_direction = "all",
               start_date = 2018,
               end_date = 2022)
```

```{r}

q_sa%>%
  ggplot(aes(x = year, y=trade_value_usd,color = factor(trade_flow), 
               shape = factor(trade_flow))) +
  geom_point(size = 2) +
  geom_line(size = 1) +
  scale_x_continuous(limits = c(min(q$year), max(q$year)), 
                     breaks = seq.int(min(q$year), max(q$year), 1)) +
  scale_color_manual(values = c("orange", "blue", "red"), 
                     name = "Trade\nFlow") +
  scale_shape_discrete(name = "Trade\nFlow") +
  labs(title = "Total Value (USD) of Zimbabwe Imports / Exports with SA, by Year", y = "Total Value (USD)") +
  theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1))

```

Monthly data is capped by a single year by api

```{r}

```
